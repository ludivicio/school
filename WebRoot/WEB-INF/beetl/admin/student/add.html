<# layout("/admin/common/_layout.html") { #>


<div class="row">
	<div class="col-md-12">
		<div class="widget">

			<div class="widget-head">
				<div class="pull-left">录入学生信息</div>
				<div class="clearfix"></div>
			</div>

			<div class="widget-content">
				<div class="padd">

					<form class="form-horizontal" action="${CONTEXT_PATH}/admin/student/save" method="post" enctype="multipart/form-data" role="form">

						<input type="hidden" value="${student.id!}" name="student.id" />
						
						<div class="form-group">
						
							<label class="control-label col-lg-1" for="student.name">姓 名</label>
							<div class="col-lg-3 ${exist( nameMsg!, 'has-error') }">
								<input type="text" class="form-control input-sm" name="student.name"
									value="${student.name!}" />
							</div>
								<p class="help-block col-lg-2">学生的完整名称（必填项）</p>
							
							<label class="control-label col-lg-1" for="student.identity">身份证</label>
							<div class="col-lg-3 ${ exist( identityMsg!, 'has-error')}">
								<input type="text" class="form-control input-sm" name="student.identity"
									value="${student.identity!}" />
							</div>
								<p class="help-block col-lg-2">学生的身份证（必填项）</p>

						</div>

						<div class="form-group">
						
						 	<label class="control-label col-lg-1" for="student.sid">学校名称</label>
							<div class="col-lg-3">
								<select class="form-control input-sm" name="student.sid" >
									<option value="-1">请选择学校</option>
									<# for(school in schoolList!){ #>
										<option value="${school.id!}" ${ school.id! == class.sid! ? "selected=selected" : "" }>${school.name!}</option>
									<# } #>
								</select>
							</div>
							<p class="help-block col-lg-2">（必填项）</p>
						
						 	<label class="control-label col-lg-1" for="student.cid">班 级</label>
							<div class="col-lg-3" id="insertClass">
								<select class="form-control input-sm" name="student.cid">
								
									<option value="-1" >请选择班级</option>
								
								</select>
								
							</div>
							<p class="help-block col-lg-2">选择学校后才有班级（必填项）</p>
						</div>
						
						<div class="form-group">
						
							<label class="control-label col-lg-1" for="student.sex">性 别</label>
							<div class="col-lg-3">
								<select class="form-control input-sm" name="student.sex">
									<option value="0" ${check(student.sex!, 0, "checked='checked'")} >女</option>
									<option value="1" ${check(student.sex!, 1, "checked='checked'")} >男</option> 
								</select>
							</div>
							<p class="help-block col-lg-2">（必填项）</p>
							
							<label class="control-label col-lg-1" for="student.status">学生状态</label>
							<div class="col-lg-3 ${ exist( statusMsg!, 'has-error') }">
								<select class="form-control input-sm" name="student.status">
									<option value="1" ${check(student.status!, 1, "checked='checked'")} >在校</option> 
									<option value="2" ${check(student.status!, 2, "checked='checked'")} >退学</option> 
									<option value="3" ${check(student.status!, 3, "checked='checked'")} >休学</option> 
									<option value="4" ${check(student.status!, 4, "checked='checked'")} >请假</option> 
								</select>
							</div>
							<p class="help-block col-lg-2">（必填项）</p>
							
						</div>						
						
						<div class="form-group">
							
							<label class="control-label col-lg-1" for="student.birthplace">籍 贯</label>
							<div class="col-lg-5 ${ exist( birthplaceMsg!, 'has-error') }">
								<input type="text" class="form-control input-sm" name="student.birthplace" value="${student.birthplace!}" />
								<p class="help-block">籍贯精确到市（县）</p>
							</div>
							
							<label class="control-label col-lg-1" for="student.birth">出生日期</label>
							<div class="col-lg-3 ${ exist( birthMsg!, 'has-error') }">
								<input type="text" class="form-control input-sm" name="student.birth"
									value="${student.birth!}" />
								<p class="help-block">出生日期例【1992-10-11】</p>
							</div>
						</div>


						<div class="form-group">
						
						 	<label class="control-label col-lg-1" for="student.national">民 族</label>
							<div class="col-lg-3 ${ exist( nationalMsg!, 'has-error') }">
								<input type="text" class="form-control input-sm" name="student.national" value="${student.national!}" />
							</div>
							<p class="help-block col-lg-2">（必填项）</p>
							
							<label class="control-label col-lg-1" for="student.feature">政治面貌</label>
							<div class="col-lg-3">
								<select class="form-control input-sm" name="student.feature">
									<option value="0" ${check(student.feature!, 0, "checked='checked'")} >党员</option>
									<option value="1" ${check(student.feature!, 1, "checked='checked'")} >团员</option> 
									<option value="2" ${check(student.feature!, 2, "checked='checked'")} >群众</option> 
								</select>
							</div>
							<p class="help-block col-lg-2">（必填项）</p>
							
						</div>

						<div class="form-group">
							
							<label class="control-label col-lg-1" for="student.address">家庭住址</label>
							<div class="col-lg-5 ${ exist( addressMsg!, 'has-error') }">
								<input type="text" class="form-control input-sm" name="student.address" value="${student.address!}" />
								<p class="help-block">填写学生的完整地址（包括省份、地区）</p>
							</div>
														
							<label class="control-label col-lg-1" for="student.phone">家长电 话</label>
							<div class="col-lg-3 ${ exist( phoneMsg!, 'has-error') }">
								<input type="text" class="form-control input-sm" name="student.phone" value="${student.phone!}" />
							</div>
							<p class="help-block col-lg-2">家长联系方式（必填项）</p>
						</div>
						
						<div class="form-group">
							<label class="control-label col-lg-1" for="student.image">图 片</label>
							<div class="col-lg-3 ${ exist( imageMsg!, 'has-error') }">
								<input type="file" class="form-control input-sm" name="student.image" value="${student.image!}" />
							</div>
							<p class="help-block col-lg-2">（必填项）</p>
							
							<label class="control-label col-lg-1" for="student.sort">排序值</label>
							<div class="col-lg-3">
								<input type="text" class="form-control input-sm" name="student.sort" value="${student.sort!}" />
								<p class="help-block">0~255之间的整数，数值越大，排序越靠前，默认为0（可选）</p>
							</div>
						</div>
						
						<div class="form-group">
	
							<label class="control-label col-lg-1" for="student.desc">学生简介</label>
							<div class="col-lg-9 ${ exist( descMsg!, 'has-error') }">
								<textarea class="form-control" name="student.desc">${student.desc!}</textarea>
							</div>
							<p class="help-block col-lg-2">（必填）</p>
		
						</div>

						<hr />
						<div class="form-group ">
							<div class="col-lg-offset-1 col-lg-9">
								<button type="submit" class="btn btn-primary">提 交</button>
								<button type="reset" class="btn btn-danger">重 置</button>
							</div>
						</div>
					</form>
				</div>
			</div>
			
			<div class="widget-foot">

			</div>
			
		</div>
	</div>
</div>


<script type="text/javascript">
	
	
	function getClass() {
		
		var value = $('select[name="student.sid"]').val();
		$.getJSON("${CONTEXT_PATH}/admin/student/getClassBySchool/" + value, function (data) {
	        
			//对请求返回的JSON格式进行分解加载
	        $.each(data.json, function(idx, item) {
	            $('select[name="student.cid"]').append($("<option/>").text(item).attr("value", idx));
	        });
			
	    });
	}
	
	
	$(document).ready(function() {
		
		
		$('select[name="student.sid"]').change(function(){  

			getClass();
			
		});
	});
		
		
		
		
		
// 		$.ajax({
			
// 			url: "${CONTEXT_PATH}/admin/student/getClassBySchool",
			
// 			data: {
				
// 				'schoolId' : $('#studentSchool').val(),
// 			},
// 			success: function(data) {
				
// 				if(data.status == "success") {
// 	    			var selectStr = "<select class='form-control input-sm' name='student.cid' >";
// 		    		$.each(data.classList, function (index,trem) { 
// 		    			selectStr+="<option value='"+trem.ID+"' >"+trem.NAME+"</option>";
// 		    		}); 
// 		    		selectStr+="</select>";
// 	    			var $select = $(selectStr);
	    	        
// 		    		$("#insertClass").empty();
// 		    		$("#insertClass").append($select);
// 				} else if(data.status == "failed") {
	// 				var $select = $("<select class='form-control input-sm' name='student.cid' disabled = 'disabled'><option value='${class.id!}' ></option></select>");
	// 	    		$("#insertClass").empty();
	// 	    		$("#insertClass").append($select);
	// 				art.dialog({
	// 					title: "获取班级失败",
	// 					icon: "error",
	// 				    content : "获取班级信息失败！<br/><br/>",
	// 					cancelVal: '返回',
	// 					cancel: true ,
	// 				});
					
// 				}
				
// 			}
// 		});
		
// 		$('#studentSchool').change(function() {
			
// 			$.ajax({
				
// 				url: "${CONTEXT_PATH}/admin/student/getClassBySchool",
	    		
// 	    		data: {
	    			
// 	    			'schoolId' : $('#studentSchool').val(),
// 	    		},
// 				success: function(data) {
					
// 					if(data.status == "success") {
// 		    			var selectStr = "<select class='form-control input-sm' name='student.cid' >";
// 	    	    		$.each(data.classList, function (index,trem) { 
// 	    	    			selectStr+="<option value='"+trem.ID+"' >"+trem.NAME+"</option>";
// 	    	    		}); 
// 	    	    		selectStr+="</select>";
// 	        			var $select = $(selectStr);
		    	        
// 			    		$("#insertClass").empty();
// 			    		$("#insertClass").append($select);
// 					} else if(data.status == "failed") {
// 						var $select = $("<select class='form-control input-sm' name='student.cid' disabled = 'disabled'><option value='${class.id!}' ></option></select>");
// 			    		$("#insertClass").empty();
// 			    		$("#insertClass").append($select);
// 						art.dialog({
// 							title: "获取班级失败",
// 							icon: "error",
// 						    content : "获取班级信息失败！<br/><br/>",
// 							cancelVal: '返回',
// 							cancel: true ,
// 						});
						
// 					}
					
// 	    		}
// 	    	});
			
// 		});
		
// 	});

</script>



<# } #>
